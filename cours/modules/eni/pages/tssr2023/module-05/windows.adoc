=  MSP 01 - Procédure sur Windows
:navtitle: Procédure : Windows

== Installation des systèmes

Pendant l'installation de Windows, j'ai laissé toutes les options par défaut

Renommage du PC en `*W10-JB*`

=== Partitionnement

Le partitionnement système ce fait sur tout le disque

image::tssr2023/msp/w10-partitionnement.png[]

=== Windows update

empêcher l'utilisation de windows update

image::tssr2023/msp/w10-majInterrompue-02.png[]

image::tssr2023/msp/w10-majInterrompue.png[]

=== Configuration du réseau

|===
| Carte réseau : Ethernet 0 (réseau 176.16.0.0/16) | Carte réseau : Ethernet 1 (réseau Eni)
a| image::tssr2023/msp/W10-JB-configReseau-eth0.png[] a| image::tssr2023/msp/W10-JB-configReseau-eth1.png[]
|===

NOTE: Configuration du réseau en executant la commande `ncpa.cpl`

==== Test ping

[source,cmd]
----
REM ping vers deb-jb
C:\Users\julie>ping 172.16.255.254

Envoi d’une requête 'Ping'  172.16.255.254 avec 32 octets de données :
Réponse de 172.16.255.254 : octets=32 temps<1ms TTL=64
Réponse de 172.16.255.254 : octets=32 temps<1ms TTL=64
Réponse de 172.16.255.254 : octets=32 temps<1ms TTL=64
Réponse de 172.16.255.254 : octets=32 temps<1ms TTL=64

Statistiques Ping pour 172.16.255.254:
    Paquets : envoyés = 4, reçus = 4, perdus = 0 (perte 0%),
Durée approximative des boucles en millisecondes :
    Minimum = 0ms, Maximum = 0ms, Moyenne = 0ms

REM ping vers W10-JB
ping 172.16.255.253
Envoi d’une requête 'Ping'  172.16.255.253 avec 32 octets de données :
Réponse de 172.16.255.253 : octets=32 temps<1ms TTL=128
Réponse de 172.16.255.253 : octets=32 temps<1ms TTL=128
Réponse de 172.16.255.253 : octets=32 temps<1ms TTL=128
Réponse de 172.16.255.253 : octets=32 temps<1ms TTL=128

Statistiques Ping pour 172.16.255.253:
    Paquets : envoyés = 4, reçus = 4, perdus = 0 (perte 0%),
Durée approximative des boucles en millisecondes :
    Minimum = 0ms, Maximum = 0ms, Moyenne = 0ms

REM Ping vers machine binôme
REM Ping vers VM Windows
C:\Users\julie>ping 172.16.0.161
Envoi d’une requête 'Ping'  172.16.0.161 avec 32 octets de données :
Réponse de 172.16.0.161 : octets=32 temps=1 ms TTL=128
Réponse de 172.16.0.161 : octets=32 temps=1 ms TTL=128
Réponse de 172.16.0.161 : octets=32 temps=1 ms TTL=128
Réponse de 172.16.0.161 : octets=32 temps=1 ms TTL=128

Statistiques Ping pour 172.16.0.161:
    Paquets : envoyés = 4, reçus = 4, perdus = 0 (perte 0%),
Durée approximative des boucles en millisecondes :
    Minimum = 1ms, Maximum = 1ms, Moyenne = 1ms

REM Ping vers VM Linux
C:\Users\julie>ping 172.16.0.162

Envoi d’une requête 'Ping'  172.16.0.162 avec 32 octets de données :
Réponse de 172.16.0.162 : octets=32 temps<1ms TTL=64
Réponse de 172.16.0.162 : octets=32 temps<1ms TTL=64
Réponse de 172.16.0.162 : octets=32 temps<1ms TTL=64
Réponse de 172.16.0.162 : octets=32 temps<1ms TTL=64

Statistiques Ping pour 172.16.0.162:
    Paquets : envoyés = 4, reçus = 4, perdus = 0 (perte 0%),
Durée approximative des boucles en millisecondes :
    Minimum = 0ms, Maximum = 0ms, Moyenne = 0ms
----


== Partie 2 – Configuration des utilisateurs et de l’environnement

=== 2.1 Création d’utilisateurs et de groupes

|===
| pseudo         | mdp                    ^.^| Groupes       | Noms
4.1+^.^| Via Cmd
|rgrimes         |	tssr@rg15_2023$	      ^.^| Direction     | Rick Grimes
|eporter  	     | tssr@ep15_2023$	     .2+^.^|  Comptabilité	| Eugene Porter
|cpeletier	     | tssr@cp15_2023$		                    | Carol Peletier (Intérimaire)
4.1+^.^| Via Powershell
|jbrindejont	 | cldras	            .2+^.^|   Informatique	| Julie Brindejont
|nleponner	     | tssr@nl15_2023$		                       | Nicolas Le Ponner
|respinosa	     | tssr@re15_2023$	    .2+^.^| Logistique |	Rosita Espinosa
|mjones	         | tssr@mj15_2023$		                         | Morgan Jones
4.1+^.^| Via graphique
|ddixon	         | tssr@dd15_2023$	   .3+^.^| Commercial    | Daryl Dixon
|gstockes        |	tssr@gs15_2023$		                     | Gabriel Stokes
|mgreene	     | tssr@mg15_2023$	                         | 	Maggie Greene
|===

Les groupe ayant accès à la machine sont : Commercial, comptabilité


.ajout compte via cmd
[source,cmd]
----
REM Ajouter des groupes utilisateurs
net localgroup Direction /add /comment:"Service Direction" 
net localgroup Comptabiliter /add /comment:"Service Comptabilité"

REM Création compte utilisateur
net user rgrimes * /add /fullname:"Rick Grimes" /comment:"Rick Grimes"
net user eporter * /add /fullname:"Eugene Porter" /comment:"Eugene Porter"
net user cpeletier * /add /fullname:"Carol Peletier" /comment:"Carol Peletier (Intérimaire)"

REM Ajouts des membres aux groupes
net localgroup Direction rgrimes /add
net localgroup Comptabiliter eporter cpeletier /add

REM Définir l'expiration des mot de passe à jamais (source web)
WMIC USERACCOUNT WHERE Name='rgrimes' SET PasswordExpires=FALSE
WMIC USERACCOUNT WHERE Name='eporter' SET PasswordExpires=FALSE
WMIC USERACCOUNT WHERE Name='cpeletier' SET PasswordExpires=FALSE

REM Désactiver certain compte
net user rgrimes
----

[source,powershell]
----
REM Ajouter des groupes utilisateurs
New-LocalGroup -Name Informatique -Description "Service Informatique"
New-LocalGroup -Name Logistique -Description "Service Logistique"

REM Création compte utilisateur
New-LocalUser -Name nleponner -Description "Nicolas Le Ponner (prestataire)" -FullName "Nicolas Le Ponner" -PasswordNeverExpires
New-LocalUser -Name respinosa -Description "Rosita Espinosa" -FullName "Rosita Espinosa" -PasswordNeverExpires
New-LocalUser -Name mjones -Description "Morgan Jones" -FullName "Morgan Jones" -PasswordNeverExpires
Rename-LocalUser -Name julie -NewName jbrindejont 
Set-LocalUser -Name jbrindejont -Description "Julie Brindejont" -FullName "Julie Brindejont" -PasswordNeverExpires $true

REM Ajouts des membres aux groupes
Add-LocalGroupMember -Name Informatique -Member nleponner
Add-LocalGroupMember -Name Informatique -Member jbrindejont
Add-LocalGroupMember -Name Logistique -Member respinosa
Add-LocalGroupMember -Name Logistique -Member mjones
----


==== Définir des heure de session pour l'utilisatrice intérimaire

[source,cmd]
----
net user cpeletier /times:lundi,vendredi,9:00,12:00
----

==== contrainte supplémentaire

===== Configuration Stratégie Global de Sécurité


image::tssr2023/msp/w10-jb-scpolMsc.png[]

===== ajout d'un compte admin pour plus de sécurité

[source,cmd]
----
REM Création compte admin
New-LocalUser -Name adm -Description "compte admin" -FullName "admin" -PasswordNeverExpires
net localgroup Administrateurs adm /add
----

===== Expiration mot de passe binôme

image::tssr2023/msp/w10-jb/expriationPasswordBinome.png[]


=== 2.2 Configuration de l’environnement de travail


* Supprimer les fonctions de gravure CD et empêcher tout accès au lecteur CD et DVD

image::tssr2023/msp/w10-jb/gpedit-refuser-acces-CD.png[]

image::tssr2023/msp/w10-jb/gpedit-suppressionGravure.png[]

* Empêcher le lancement des outils de modification du registre (comme regedit…)

image::tssr2023/msp/w10-jb/gpedit-refuserAccesRegEdit.png[]

* Forcer l’utilisation d’une image de votre choix en tant que fond d’écran

image::tssr2023/msp/w10-jb/gpedit-papier-peint.png[]

* En outre, le pare-feu devra être obligatoirement actif sur le poste Windows, quel que soit l’utilisateur connecté.

image::tssr2023/msp/w10-jb/gpedit-firewall.png[]


== Partie 3 - Configuration du stockage et des ressources


=== Partitionnement de disques

Utilisation de l'outils `diskpart` de Windows

[source,cmd]
----
diskpart
select disk 1
create partition primary size=10240
select partition 1
format fs=ntfs label=DATA quick
assign letter=d
extend size=5120
----